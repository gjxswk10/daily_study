[TOC]



# 2025年日志汇总

## 2025-04-08

## 开发九野个人版踩坑记录

## 一、网络匹配参考

主要参考这个网址：https://developer.unity.cn/projects/67d299e1edbc2a2b119bb6de

框架：multiverse+netcode+matchmaking，协议websocket/kcp

目前已全部跑通，接下来在这基础上开发九野。

*** 微信端开发工具的APPID，注意，小程序和小游戏是不一样的

### 1. 解决中文字符问题

#### 1.1 查找并复制中文字体

windows： 进入文件C:\windows\Fonts

选择其中一个字体，比如“楷体 常规”，复制进入项目的Assests/Resources/Fonts目录下。

![查找系统中文字体](.\photo\查找中文字符.png)

#### 1.2 生成TextMeshPro字符集

右键点击刚加入的字体文件，选择“Create->TextMeshPro->FontAssest”生成。

![生成Unity字符集](.\photo\生成UnityTextMeshPro字符集.png)

#### 1.3 使用中文字体

在需要使用中文字体的地方，将Font Asset设置为刚刚生成的字体。

![使用中文字体](.\photo\在使用处使用中文字符.png)



## 2025-04-09

### 一、加入Git版本管理

一开始直接在大项目下git init，结果数据太大很难跑通，实际上只要加入

* Assests/
* ProjectSettings/

这两上文件夹的版本管理即可。目前我是这样做的（网上介绍，这样最简），后续看会不会有其他影响。

## 2025-04-10

### 一、调通1v1 matchmaking模式

查找一天bug，未果

## 2025-04-12

### 一、调通1v1 matchmaking的问题



***解决方法：使用websocket代替kcp***

分析：不知道是不是因为kcp在底层使用udp的原因，导致之前基于示例教程中使用1v1 matchmaking进行匹配总是出bug，现象是：能够匹配成功，但在客户端却不绘制玩家预制体。

今天又调试查找了一天，能定位到错误出现在StartClient()这里，服务器能正确建立，客户端也能正确获得服务器的ip及端口，但就是不能建立起连接。

然后没有办法，想着试试websocket吧，结果一遍就过了。看来确实是kcp协议的问题，查了下，kcp底层一般是udp，它本身是一个中间层协议，并不处理底层网络协议，用户要自己定义底层的发送方式，并且通过回调传递给KCP。可能就是这个原因导致的吧。

之前想用KCP的原因是它快，且跟微信小游戏适配更好，现在看来可能需要额外配置一些东西才能使KCP协议在这里工作。

好吧，总算搞定这个问题了，快三天了吧！！！

### 二、客户端权威 or 服务器权威

在考虑这个问题，Unity 3D没有现成的客户端权威代码，在学的示例也是服务器权威的。但感觉客户端权威更符合我的需求，但可能需要更多的改动，目前尚在权衡。

后边想了想，暂时不纠结这个问题，先把本地资源和场景布局做好，之后需要服务器同步的资源再丢给服务器，其他就在本地计算。

看了下九野的日志，可以明确确定是“帧同步”的写法。

## 2025-04-13

### 一、重构九野资源

找到了之前做的Test Bundle程序，重新加载了九野的3D模型，用Instantiate可以恢复大部分数据，但无法处理Texture2D类型，导致加载的3D人物模型丢失纹理。尝试了一些方法，无果。无法完全还原带纹理的3D模型。

看到了Unity 3D新出现的工具Addressables，打算用新工具尝试一下，看看能不能完全还原人物模型。

## 2025-04-17

## 一、折腾Addressables

折腾了这些天的Addressables，以为能直接用它来正确、完整地加载AssetBundle文件，完美还原所有模型和依赖关系，结果今晚才发现：不能！！！它还是要用AssetBundle自身的API来进行加载。好吧，白忙活这些天了。

以后要加快文档阅读速度，提高效率，抓住重点，避免浪费无意义的时间。



## 2025-04-18

### 一、重新思考AssetBundle正确加载模型的问题

做了以下尝试：

* 重试了异步写法（于本次目标而言无关紧要，只是为了长远做准备）；
* 尝试了预加载，先加载Material、Texture2D，再加载类型，失败；
* 学习B站Up主LC_ilmlp关于Shader、MonoBehaviour的读取；
* 重新分析Card_284_001.ab结构，分析各个MonoBehaviour间的关系；
* 确定Card_284_001.ab中包含Manifest清单，最终找到files/dat文件下的总Manifest文件；
* 初步分析Manifest中给出的依赖项。





